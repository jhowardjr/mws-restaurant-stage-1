"use strict";var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function v(){_classCallCheck(this,v)}return _createClass(v,null,[{key:"fetchRestaurants",value:function(n){var r=new XMLHttpRequest;r.open("GET",v.DATABASE_URL),r.onload=function(){if(200===r.status){var e=JSON.parse(r.responseText);n(null,e)}else{var t="Request failed. Returned status of "+r.status;n(t,null)}},r.send()}},{key:"fetchRestaurantById",value:function(r,u){v.fetchRestaurants(function(e,t){if(e)u(e,null);else{var n=t.find(function(e){return e.id==r});n?u(null,n):u("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(r,u){v.fetchRestaurants(function(e,t){if(e)u(e,null);else{var n=t.filter(function(e){return e.cuisine_type==r});u(null,n)}})}},{key:"fetchRestaurantByNeighborhood",value:function(r,u){v.fetchRestaurants(function(e,t){if(e)u(e,null);else{var n=t.filter(function(e){return e.neighborhood==r});u(null,n)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(r,u,a){v.fetchRestaurants(function(e,t){if(e)a(e,null);else{var n=t;"all"!=r&&(n=n.filter(function(e){return e.cuisine_type==r})),"all"!=u&&(n=n.filter(function(e){return e.neighborhood==u})),a(null,n)}})}},{key:"fetchNeighborhoods",value:function(u){v.fetchRestaurants(function(e,n){if(e)u(e,null);else{var r=n.map(function(e,t){return n[t].neighborhood}),t=r.filter(function(e,t){return r.indexOf(e)==t});u(null,t)}})}},{key:"fetchCuisines",value:function(u){v.fetchRestaurants(function(e,n){if(e)u(e,null);else{var r=n.map(function(e,t){return n[t].cuisine_type}),t=r.filter(function(e,t){return r.indexOf(e)==t});u(null,t)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return"/img/"+e.photograph+".jpg"}},{key:"srcsetUrlForRestaurant",value:function(e,t,n){return"/img/scaled/"+e.id+t+" "+n}},{key:"generateSrcset",value:function(e,t,n){var r=[],u=[],a=!0,i=!1,l=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var f=o.value,c=v.sizeAttribute(f.media,f.slot),h=v.srcsetUrlForRestaurant(e,f.suffix,f.size);r.push(h),u.push(c)}}catch(e){i=!0,l=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw l}}n.alt=e.name,n.src=v.imageUrlForRestaurant(e),n.srcset=r.join(),n.sizes=u.join()}},{key:"sizeAttribute",value:function(e,t){return e+" "+t}},{key:"mapMarkerForRestaurant",value:function(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:v.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants"}}]),v}();
"use strict";var map,restaurant=void 0;window.initMap=function(){fetchRestaurantFromURL(function(e,n){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:n.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})};var fetchRestaurantFromURL=function(t){if(self.restaurant)t(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,n){(self.restaurant=n)?(fillRestaurantHTML(),t(null,n)):console.error(e)}):(error="No restaurant id in URL",t(error,null))}},fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var n=document.getElementById("restaurant-img");n.className="restaurant-img",n.src=DBHelper.imageUrlForRestaurant(e);DBHelper.generateSrcset(e,[{media:"(max-width: 320px)",suffix:"_280.jpg",size:"280w",slot:"280px"},{media:"(min-width: 375px)",suffix:"_385.jpg",size:"385w",slot:"385px"},{media:"((min-width: 425px) and (max-width: 767px))",suffix:"_640.jpg",size:"640w",slot:""},{media:"(min-width: 425px)",suffix:"_640.jpg",size:"640w",slot:"432px"}],n),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,n=document.getElementById("restaurant-hours"),t=document.createElement("caption");for(var r in t.innerHTML=self.restaurant.name+"'s Hours of Operation",n.appendChild(t),e){var a=document.createElement("tr"),i=document.createElement("td");i.innerHTML=r,a.appendChild(i);var l=document.createElement("td");l.innerHTML=e[r],a.appendChild(l),n.appendChild(a)}},fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,n=document.getElementById("reviews-container"),t=document.createElement("h2");if(t.innerHTML="Reviews",n.appendChild(t),!e){var r=document.createElement("p");return r.innerHTML="No reviews yet!",void n.appendChild(r)}var a=document.getElementById("reviews-list");e.forEach(function(e){a.appendChild(createReviewHTML(e))}),n.appendChild(a)},createReviewHTML=function(e){var n=document.createElement("li"),t=document.createElement("p");t.innerHTML=e.name,n.appendChild(t);var r=document.createElement("p");r.innerHTML=e.date,n.appendChild(r);var a=document.createElement("p");a.innerHTML="Rating: "+e.rating,n.appendChild(a);var i=document.createElement("p");return i.innerHTML=e.comments,n.appendChild(i),n},fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,n=document.getElementById("breadcrumb"),t=document.createElement("li");t.innerHTML=e.name,n.appendChild(t)},getParameterByName=function(e,n){n||(n=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(n);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null};